{"id":"../node_modules/http-link-dataloader/dist/src/BatchedGraphQLClient.js","dependencies":[{"name":"/Users/valentinoespinoza/Handshake/check-in-kiosk-node/node_modules/http-link-dataloader/dist/src/BatchedGraphQLClient.js.map","includedInParent":true,"mtime":1582757696019},{"name":"/Users/valentinoespinoza/Handshake/check-in-kiosk-node/package.json","includedInParent":true,"mtime":1582928465535},{"name":"/Users/valentinoespinoza/Handshake/check-in-kiosk-node/node_modules/http-link-dataloader/package.json","includedInParent":true,"mtime":1582757696019},{"name":"cross-fetch/polyfill","loc":{"line":46,"column":8},"parent":"/Users/valentinoespinoza/Handshake/check-in-kiosk-node/node_modules/http-link-dataloader/dist/src/BatchedGraphQLClient.js","resolved":"/Users/valentinoespinoza/Handshake/check-in-kiosk-node/node_modules/cross-fetch/dist/browser-polyfill.js"},{"name":"dataloader","loc":{"line":47,"column":25},"parent":"/Users/valentinoespinoza/Handshake/check-in-kiosk-node/node_modules/http-link-dataloader/dist/src/BatchedGraphQLClient.js","resolved":"/Users/valentinoespinoza/Handshake/check-in-kiosk-node/node_modules/dataloader/index.js"},{"name":"./ClientError","loc":{"line":48,"column":28},"parent":"/Users/valentinoespinoza/Handshake/check-in-kiosk-node/node_modules/http-link-dataloader/dist/src/BatchedGraphQLClient.js","resolved":"/Users/valentinoespinoza/Handshake/check-in-kiosk-node/node_modules/http-link-dataloader/dist/src/ClientError.js"}],"generated":{"js":"\"use strict\";\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"cross-fetch/polyfill\");\nvar DataLoader = require(\"dataloader\");\nvar ClientError_1 = require(\"./ClientError\");\nvar BatchedGraphQLClient = /** @class */ (function () {\n    function BatchedGraphQLClient(uri, options) {\n        var _this = this;\n        this.load = function (keys) { return __awaiter(_this, void 0, void 0, function () {\n            var requests, body, response, results, errorIndex, result, errorResult;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        requests = keys.map(function (k) { return JSON.parse(k); });\n                        body = JSON.stringify(requests);\n                        return [4 /*yield*/, fetch(this.uri, __assign({ method: 'POST' }, this.options, { headers: Object.assign({ 'Content-Type': 'application/json' }, this.options.headers), body: body }))];\n                    case 1:\n                        response = _a.sent();\n                        return [4 /*yield*/, getResults(response)\n                            // if it is not an array, there must be an error\n                        ];\n                    case 2:\n                        results = _a.sent();\n                        // if it is not an array, there must be an error\n                        if (!Array.isArray(results)) {\n                            throw new ClientError_1.ClientError(__assign({}, results, { status: response.status }));\n                        }\n                        // check if there was an error in one of the responses\n                        if (!response.ok ||\n                            results.some(function (r) { return r.errors !== undefined || r.data === undefined; })) {\n                            errorIndex = results.findIndex(function (r) { return r.errors !== undefined || r.data === undefined; });\n                            result = results[errorIndex];\n                            errorResult = typeof result === 'string' ? { errors: [{ message: result }] } : result;\n                            throw new ClientError_1.ClientError(__assign({}, errorResult, { status: response.status }));\n                        }\n                        return [2 /*return*/, results.map(function (r) { return r.data; })];\n                }\n            });\n        }); };\n        this.uri = uri;\n        var cache = options && typeof options.cacheResults !== 'undefined'\n            ? options.cacheResults\n            : false;\n        if (options && typeof options.cacheResults !== 'undefined') {\n            delete options.cacheResults;\n        }\n        this.options = options || {};\n        this.dataloader = new DataLoader(this.load, { cache: cache });\n    }\n    BatchedGraphQLClient.prototype.request = function (query, variables, operationName) {\n        return __awaiter(this, void 0, void 0, function () {\n            var body;\n            return __generator(this, function (_a) {\n                body = JSON.stringify({\n                    query: query,\n                    variables: variables ? variables : undefined,\n                    operationName: operationName ? operationName : undefined,\n                });\n                return [2 /*return*/, this.dataloader.load(body)];\n            });\n        });\n    };\n    return BatchedGraphQLClient;\n}());\nexports.BatchedGraphQLClient = BatchedGraphQLClient;\nfunction getResults(response) {\n    var contentType = response.headers.get('Content-Type');\n    if (contentType && contentType.startsWith('application/json')) {\n        return response.json();\n    }\n    else {\n        return response.text();\n    }\n}\n"},"sourceMaps":{"js":{"version":3,"file":"BatchedGraphQLClient.js","sourceRoot":"","sources":["../../src/BatchedGraphQLClient.ts"],"names":[],"mappings":"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","sourcesContent":[null]}},"error":null,"hash":"de022c5279b59245f205550e22b52ff2","cacheData":{"env":{}}}